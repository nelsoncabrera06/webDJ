<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DJ Mix Web - Professional DJ Software</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/deck.css">
    <link rel="stylesheet" href="css/mixer.css">
    <link rel="stylesheet" href="css/waveform.css">
    <link rel="stylesheet" href="css/platter.css">
    <link rel="stylesheet" href="css/browser.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>DJ Mix Web</h1>
            <div class="header-controls">
                <div class="midi-indicator" id="midiIndicator" title="MIDI Controller">
                    <span class="midi-icon">&#9835;</span>
                    <span class="midi-status">MIDI</span>
                </div>
                <span id="masterBpm">Master: -- BPM</span>
                <button class="settings-btn" id="settingsBtn" title="Settings">
                    <span class="settings-icon">&#9881;</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Zoomed Waveforms Display -->
            <section class="waveforms-section">
                <div class="zoomed-waveform-container">
                    <canvas id="zoomedWaveformA" class="zoomed-waveform deck-a"></canvas>
                    <canvas id="zoomedWaveformB" class="zoomed-waveform deck-b"></canvas>
                    <div class="playhead-indicator"></div>
                </div>
            </section>

            <!-- Decks and Mixer -->
            <section class="decks-section">
                <!-- Deck A -->
                <div class="deck" id="deckA" data-deck="A">
                    <div class="deck-header">
                        <span class="deck-label">DECK A</span>
                        <div class="track-info">
                            <span class="track-name" id="trackNameA">No Track Loaded</span>
                            <span class="track-bpm" id="trackBpmA">-- BPM</span>
                        </div>
                    </div>

                    <!-- Mini Waveform -->
                    <div class="mini-waveform-container">
                        <canvas id="waveformA" class="mini-waveform"></canvas>
                        <div class="waveform-time">
                            <span id="currentTimeA">0:00</span>
                            <span id="totalTimeA">0:00</span>
                        </div>
                    </div>

                    <!-- Load Button / Drop Zone (full width) -->
                    <div class="load-zone" id="loadZoneA">
                        <input type="file" id="fileInputA" accept="audio/*" hidden>
                        <button class="load-btn" onclick="document.getElementById('fileInputA').click()">
                            Load Track
                        </button>
                        <span class="drop-hint">or drag & drop</span>
                    </div>

                    <!-- Deck A Controls Column -->
                    <div class="deck-controls">
                        <!-- FX Section -->
                        <div class="fx-section">
                            <span class="section-label">FX</span>
                            <div class="fx-controls">
                                <div class="fx-knob-group">
                                    <div class="knob fx-knob" id="fxFilterA" data-value="0" data-min="0" data-max="100"></div>
                                    <span class="fx-label">FILTER</span>
                                </div>
                                <div class="fx-knob-group">
                                    <div class="knob fx-knob" id="fxFlangerA" data-value="0" data-min="0" data-max="100"></div>
                                    <span class="fx-label">FLANGER</span>
                                </div>
                                <div class="fx-knob-group">
                                    <div class="knob fx-knob" id="fxEchoA" data-value="0" data-min="0" data-max="100"></div>
                                    <span class="fx-label">ECHO</span>
                                </div>
                            </div>
                        </div>

                        <!-- Loop Controls -->
                        <div class="loop-controls">
                            <span class="section-label">LOOP</span>
                            <div class="loop-buttons">
                                <button class="loop-btn loop-halve" id="loopHalveA" title="Halve loop">&lt;</button>
                                <button class="loop-btn loop-toggle" id="loopToggleA" title="Toggle loop">4</button>
                                <button class="loop-btn loop-double" id="loopDoubleA" title="Double loop">&gt;</button>
                            </div>
                        </div>

                        <!-- Pads Section -->
                        <div class="pads-section">
                            <span class="section-label">PADS</span>
                            <div class="pads-grid">
                                <button class="pad-btn" id="padA1">1</button>
                                <button class="pad-btn" id="padA2">2</button>
                                <button class="pad-btn" id="padA3">3</button>
                                <button class="pad-btn" id="padA4">4</button>
                                <button class="pad-btn" id="padA5">5</button>
                                <button class="pad-btn" id="padA6">6</button>
                                <button class="pad-btn" id="padA7">7</button>
                                <button class="pad-btn" id="padA8">8</button>
                            </div>
                        </div>

                        <!-- Hot Cues -->
                        <div class="hot-cues-container">
                            <span class="section-label">HOT CUE</span>
                            <div class="hot-cues-content">
                                <div class="hot-cues-grid">
                                    <div class="hot-cues-row">
                                        <button class="hot-cue-btn" id="hotCueA1">1</button>
                                        <button class="hot-cue-btn" id="hotCueA2">2</button>
                                        <button class="hot-cue-btn" id="hotCueA3">3</button>
                                        <button class="hot-cue-btn" id="hotCueA4">4</button>
                                    </div>
                                    <div class="hot-cues-row">
                                        <button class="hot-cue-btn" id="hotCueA5">5</button>
                                        <button class="hot-cue-btn" id="hotCueA6">6</button>
                                        <button class="hot-cue-btn" id="hotCueA7">7</button>
                                        <button class="hot-cue-btn" id="hotCueA8">8</button>
                                    </div>
                                </div>
                                <button class="del-btn" id="delA">DEL</button>
                            </div>
                        </div>

                    </div>

                    <!-- Deck A Platter Column -->
                    <div class="deck-platter">
                        <!-- Platter with Tempo -->
                        <div class="platter-tempo-row">
                            <!-- Tempo & Pitch (left of platter, away from mixer) -->
                            <div class="platter-tempo-pitch">
                                <div class="platter-tempo">
                                    <label>TEMPO</label>
                                    <div class="tempo-slider-container">
                                        <input type="range" id="tempoA" class="vertical-slider" min="0.5" max="1.5" step="0.01" value="1.0" orient="vertical">
                                        <button class="reset-tempo-btn" id="resetTempoA" title="Reset tempo">&#9664;</button>
                                    </div>
                                    <span class="control-value" id="tempoValueA">1.00x</span>
                                </div>
                                <div class="platter-pitch pitch-control">
                                    <label>PITCH</label>
                                    <input type="range" id="pitchA" class="vertical-slider" min="-12" max="12" step="0.1" value="0" orient="vertical">
                                    <span class="control-value" id="pitchValueA">0 st</span>
                                </div>
                            </div>
                            <!-- Platter -->
                            <div class="platter-container">
                                <div class="platter" id="platterA">
                                    <div class="vinyl-disc">
                                        <div class="vinyl-marker"></div>
                                        <div class="vinyl-label">
                                            <div class="vinyl-hole"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Transport Controls (below platter) -->
                        <div class="platter-transport">
                            <button class="transport-btn play-btn" id="playA">
                                <span class="icon">▶</span>
                            </button>
                            <button class="transport-btn pause-btn" id="pauseA">
                                <span class="icon">⏸</span>
                            </button>
                            <button class="transport-btn stop-btn" id="stopA">
                                <span class="icon">⏹</span>
                            </button>
                            <button class="transport-btn cue-btn" id="cueA">
                                CUE
                            </button>
                            <button class="transport-btn sync-btn" id="syncA">
                                SYNC
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Mixer -->
                <div class="mixer" id="mixer">
                    <div class="mixer-header">
                        <span>MIXER</span>
                    </div>

                    <!-- Main Mixer Controls -->
                    <div class="mixer-controls">
                        <!-- Deck A: Volume + Meter -->
                        <div class="channel-strip deck-a-strip">
                            <label class="channel-label">A</label>
                            <div class="channel-controls">
                                <input type="range" id="volumeA" class="volume-fader" min="0" max="1" step="0.01" value="1" orient="vertical">
                                <div class="volume-meter" id="meterA">
                                    <div class="meter-fill"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Deck A EQ -->
                        <div class="eq-column" id="eqA">
                            <div class="eq-knob-container">
                                <label>HI</label>
                                <div class="knob" id="eqHighA" data-value="0" data-min="-12" data-max="12"></div>
                                <span class="knob-value">0</span>
                            </div>
                            <div class="eq-knob-container">
                                <label>MID</label>
                                <div class="knob" id="eqMidA" data-value="0" data-min="-12" data-max="12"></div>
                                <span class="knob-value">0</span>
                            </div>
                            <div class="eq-knob-container">
                                <label>LOW</label>
                                <div class="knob" id="eqLowA" data-value="0" data-min="-12" data-max="12"></div>
                                <span class="knob-value">0</span>
                            </div>
                        </div>

                        <!-- Deck B EQ -->
                        <div class="eq-column" id="eqB">
                            <div class="eq-knob-container">
                                <label>HI</label>
                                <div class="knob" id="eqHighB" data-value="0" data-min="-12" data-max="12"></div>
                                <span class="knob-value">0</span>
                            </div>
                            <div class="eq-knob-container">
                                <label>MID</label>
                                <div class="knob" id="eqMidB" data-value="0" data-min="-12" data-max="12"></div>
                                <span class="knob-value">0</span>
                            </div>
                            <div class="eq-knob-container">
                                <label>LOW</label>
                                <div class="knob" id="eqLowB" data-value="0" data-min="-12" data-max="12"></div>
                                <span class="knob-value">0</span>
                            </div>
                        </div>

                        <!-- Deck B: Meter + Volume -->
                        <div class="channel-strip deck-b-strip">
                            <label class="channel-label">B</label>
                            <div class="channel-controls">
                                <div class="volume-meter" id="meterB">
                                    <div class="meter-fill"></div>
                                </div>
                                <input type="range" id="volumeB" class="volume-fader" min="0" max="1" step="0.01" value="1" orient="vertical">
                            </div>
                        </div>
                    </div>

                    <!-- Crossfader -->
                    <div class="crossfader-section">
                        <label>CROSSFADER</label>
                        <div class="crossfader-container">
                            <span class="cf-label">A</span>
                            <input type="range" id="crossfader" class="crossfader" min="0" max="1" step="0.01" value="0.5">
                            <span class="cf-label">B</span>
                        </div>
                    </div>
                </div>

                <!-- Deck B -->
                <div class="deck" id="deckB" data-deck="B">
                    <div class="deck-header">
                        <span class="deck-label">DECK B</span>
                        <div class="track-info">
                            <span class="track-name" id="trackNameB">No Track Loaded</span>
                            <span class="track-bpm" id="trackBpmB">-- BPM</span>
                        </div>
                    </div>

                    <!-- Mini Waveform -->
                    <div class="mini-waveform-container">
                        <canvas id="waveformB" class="mini-waveform"></canvas>
                        <div class="waveform-time">
                            <span id="currentTimeB">0:00</span>
                            <span id="totalTimeB">0:00</span>
                        </div>
                    </div>

                    <!-- Load Button / Drop Zone (full width) -->
                    <div class="load-zone" id="loadZoneB">
                        <input type="file" id="fileInputB" accept="audio/*" hidden>
                        <button class="load-btn" onclick="document.getElementById('fileInputB').click()">
                            Load Track
                        </button>
                        <span class="drop-hint">or drag & drop</span>
                    </div>

                    <!-- Deck B Platter Column (on left, near mixer) -->
                    <div class="deck-platter">
                        <!-- Platter with Tempo -->
                        <div class="platter-tempo-row">
                            <!-- Tempo & Pitch (right of platter, away from mixer - CSS handles direction) -->
                            <div class="platter-tempo-pitch">
                                <div class="platter-tempo">
                                    <label>TEMPO</label>
                                    <div class="tempo-slider-container">
                                        <button class="reset-tempo-btn" id="resetTempoB" title="Reset tempo">&#9654;</button>
                                        <input type="range" id="tempoB" class="vertical-slider" min="0.5" max="1.5" step="0.01" value="1.0" orient="vertical">
                                    </div>
                                    <span class="control-value" id="tempoValueB">1.00x</span>
                                </div>
                                <div class="platter-pitch pitch-control">
                                    <label>PITCH</label>
                                    <input type="range" id="pitchB" class="vertical-slider" min="-12" max="12" step="0.1" value="0" orient="vertical">
                                    <span class="control-value" id="pitchValueB">0 st</span>
                                </div>
                            </div>
                            <!-- Platter -->
                            <div class="platter-container">
                                <div class="platter" id="platterB">
                                    <div class="vinyl-disc">
                                        <div class="vinyl-marker"></div>
                                        <div class="vinyl-label">
                                            <div class="vinyl-hole"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Transport Controls (below platter) -->
                        <div class="platter-transport">
                            <button class="transport-btn play-btn" id="playB">
                                <span class="icon">▶</span>
                            </button>
                            <button class="transport-btn pause-btn" id="pauseB">
                                <span class="icon">⏸</span>
                            </button>
                            <button class="transport-btn stop-btn" id="stopB">
                                <span class="icon">⏹</span>
                            </button>
                            <button class="transport-btn cue-btn" id="cueB">
                                CUE
                            </button>
                            <button class="transport-btn sync-btn" id="syncB">
                                SYNC
                            </button>
                        </div>
                    </div>

                    <!-- Deck B Controls Column -->
                    <div class="deck-controls">
                        <!-- FX Section -->
                        <div class="fx-section">
                            <span class="section-label">FX</span>
                            <div class="fx-controls">
                                <div class="fx-knob-group">
                                    <div class="knob fx-knob" id="fxFilterB" data-value="0" data-min="0" data-max="100"></div>
                                    <span class="fx-label">FILTER</span>
                                </div>
                                <div class="fx-knob-group">
                                    <div class="knob fx-knob" id="fxFlangerB" data-value="0" data-min="0" data-max="100"></div>
                                    <span class="fx-label">FLANGER</span>
                                </div>
                                <div class="fx-knob-group">
                                    <div class="knob fx-knob" id="fxEchoB" data-value="0" data-min="0" data-max="100"></div>
                                    <span class="fx-label">ECHO</span>
                                </div>
                            </div>
                        </div>

                        <!-- Loop Controls -->
                        <div class="loop-controls">
                            <span class="section-label">LOOP</span>
                            <div class="loop-buttons">
                                <button class="loop-btn loop-halve" id="loopHalveB" title="Halve loop">&lt;</button>
                                <button class="loop-btn loop-toggle" id="loopToggleB" title="Toggle loop">4</button>
                                <button class="loop-btn loop-double" id="loopDoubleB" title="Double loop">&gt;</button>
                            </div>
                        </div>

                        <!-- Pads Section -->
                        <div class="pads-section">
                            <span class="section-label">PADS</span>
                            <div class="pads-grid">
                                <button class="pad-btn" id="padB1">1</button>
                                <button class="pad-btn" id="padB2">2</button>
                                <button class="pad-btn" id="padB3">3</button>
                                <button class="pad-btn" id="padB4">4</button>
                                <button class="pad-btn" id="padB5">5</button>
                                <button class="pad-btn" id="padB6">6</button>
                                <button class="pad-btn" id="padB7">7</button>
                                <button class="pad-btn" id="padB8">8</button>
                            </div>
                        </div>

                        <!-- Hot Cues -->
                        <div class="hot-cues-container">
                            <span class="section-label">HOT CUE</span>
                            <div class="hot-cues-content">
                                <div class="hot-cues-grid">
                                    <div class="hot-cues-row">
                                        <button class="hot-cue-btn" id="hotCueB1">1</button>
                                        <button class="hot-cue-btn" id="hotCueB2">2</button>
                                        <button class="hot-cue-btn" id="hotCueB3">3</button>
                                        <button class="hot-cue-btn" id="hotCueB4">4</button>
                                    </div>
                                    <div class="hot-cues-row">
                                        <button class="hot-cue-btn" id="hotCueB5">5</button>
                                        <button class="hot-cue-btn" id="hotCueB6">6</button>
                                        <button class="hot-cue-btn" id="hotCueB7">7</button>
                                        <button class="hot-cue-btn" id="hotCueB8">8</button>
                                    </div>
                                </div>
                                <button class="del-btn" id="delB">DEL</button>
                            </div>
                        </div>

                    </div>
                </div>
            </section>

            <!-- Browser Section -->
            <section class="browser-section" id="browserSection">
                <!-- Resize Handle -->
                <div class="browser-resize-handle" id="browserResizeHandle"></div>

                <!-- Browser Content -->
                <div class="browser-content">
                <!-- Folder Browser -->
                <div class="folder-browser">
                    <div class="browser-header">
                        <span class="browser-title">BROWSER</span>
                        <button class="browser-btn" id="openFolderBtn" title="Open Folder">
                            <span>+ Add Folder</span>
                        </button>
                    </div>
                    <div class="folder-tree" id="folderTree">
                        <div class="folder-placeholder">
                            <span>Click "Add Folder" to browse music</span>
                        </div>
                    </div>
                    <div class="file-list" id="fileList">
                        <div class="file-list-header">
                            <span class="col-name">Name</span>
                            <span class="col-duration">Duration</span>
                        </div>
                        <div class="file-list-content" id="fileListContent">
                            <div class="file-placeholder">
                                <span>Select a folder to view files</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Playlist -->
                <div class="playlist-panel">
                    <div class="browser-header">
                        <span class="browser-title">PLAYLIST</span>
                        <div class="playlist-controls">
                            <span class="playlist-count" id="playlistCount">0 tracks</span>
                            <button class="browser-btn small" id="clearPlaylistBtn" title="Clear Playlist">Clear</button>
                        </div>
                    </div>
                    <div class="playlist-content" id="playlistContent">
                        <div class="playlist-placeholder">
                            <span>Drag tracks here to add to playlist</span>
                        </div>
                    </div>
                </div>
                </div><!-- /browser-content -->
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <span>DJ Mix Web - Built with Web Audio API</span>
        </footer>

        <!-- Settings Modal -->
        <div class="settings-modal" id="settingsModal">
            <div class="settings-panel">
                <div class="settings-header">
                    <h2>Settings</h2>
                    <button class="close-btn" id="closeSettings">&times;</button>
                </div>
                <div class="settings-content">
                    <div class="setting-item">
                        <div class="setting-label">
                            <span class="setting-title">Pitch Mode</span>
                            <span class="setting-desc">How tempo affects pitch</span>
                        </div>
                        <div class="setting-control">
                            <select id="pitchMode">
                                <option value="linked" selected>Linked (pitch stays constant)</option>
                                <option value="independent">Independent (vinyl style)</option>
                            </select>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <span class="setting-title">Auto Mix</span>
                            <span class="setting-desc">Automatic crossfade 10 seconds before track ends</span>
                        </div>
                        <div class="setting-control">
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoMixEnabled">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Click to Start Overlay -->
    <div class="start-overlay" id="startOverlay">
        <div class="start-content">
            <div class="start-icon">&#9654;</div>
            <span class="start-text">Click to start</span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/bpmDetector.js"></script>
    <script src="js/waveformGenerator.js"></script>
    <script src="js/audioEngine.js"></script>
    <script src="js/deck.js"></script>
    <script src="js/mixer.js"></script>
    <script src="js/knob.js"></script>
    <script src="js/midi.js"></script>
    <script src="js/platter.js"></script>
    <script src="js/autoMixer.js"></script>
    <script src="js/browser.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
